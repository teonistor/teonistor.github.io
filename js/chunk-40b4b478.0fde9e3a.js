(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-40b4b478"],{"0881":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:""}},[n("v-row",[n("v-col",{attrs:{cols:"4"}},[n("h3",[t._v("Filters")]),t.filters.length?t._e():n("button",{attrs:{disabled:"",loading:""}}),n("v-expansion-panels",{attrs:{popout:""}},t._l(t.filters,(function(e){return n("v-expansion-panel",{key:e.name,attrs:{hover:"",focusable:"",popout:""}},[n("v-expansion-panel-header",[t._v(" "+t._s(e.name)+" ")]),e.values.length<20?n("v-expansion-panel-content",t._l(e.values,(function(e){return n("v-checkbox",{key:e.label,attrs:{label:t.computeFilterLabel(e),disabled:!e.enabled},on:{change:function(e){return t.onFilterChange()}},model:{value:e.selected,callback:function(n){t.$set(e,"selected",n)},expression:"value.selected"}})})),1):n("v-expansion-panel-content",["Interlocutors"===e.name?n("span",[n("small",{staticStyle:{opacity:"0.66"}},[t._v("Sorry that some names which should be the same aren't and some which shouldn't be are. Data quality is difficult.")])]):t._e(),n("v-autocomplete",{attrs:{chips:"","deletable-chips":"",clearable:"",multiple:"",solo:"",items:t.computeListedItems(e)},on:{change:function(n){return t.onListedFilterChange(e)}},model:{value:e.listed,callback:function(n){t.$set(e,"listed",n)},expression:"filter.listed"}})],1)],1)})),1)],1),n("v-col",{attrs:{cols:"8"}},[t.restCallsGoing?n("v-progress-circular",{staticStyle:{width:"100%",height:"28px"},attrs:{indeterminate:""}}):n("span",[t.results.length?n("h3",[t._v(t._s(t.truncatedResults.length)+" of "+t._s(t.results.length)+" shown")]):n("h3",[t._v(" Found nothing. "),n("span",{staticStyle:{"font-size":"medium"}},[t._v("Perhaps the filters are set in an impossible combination or you may need to "),t.loggedIn?n("span",[t._v("logout and login as another user")]):n("a",{attrs:{href:t.loginRdrHref}},[t._v("login")]),t._v(" . ")])])]),n("v-checkbox",{attrs:{label:"Shuffle"},model:{value:t.shuffle,callback:function(e){t.shuffle=e},expression:"shuffle"}}),n("hr"),t._l(t.truncatedResults,(function(e,r){return n("p",{key:r,domProps:{innerHTML:t._s(e)}})})),t.results.length>t.resultsShown?n("v-btn",{on:{click:function(e){return t.showMore()}}},[t._v("Show more...")]):t._e(),n("Notifications",{attrs:{alerts:t.alerts,floating:!0}})],2)],1)],1)},i=[],a=(n("4de4"),n("5db7"),n("4160"),n("a630"),n("c975"),n("a15b"),n("d81d"),n("73d9"),n("b0c0"),n("b64b"),n("d3b7"),n("ac1f"),n("3ca3"),n("5319"),n("159b"),n("ddb0"),n("bc3a")),o=n.n(a),s=n("2cc9"),l=n("c4f7"),u=n("343b"),c=n("e5a4"),f=n("e985"),d={components:{HtmlEntry:c["a"],Notifications:f["a"]},mixins:[u["a"]],props:["loggedIn"],data:function(){return{results:[],shuffle:!0,resultsShown:30,loginRdrHref:"/",filtersFirstLoaded:!0,filters:[]}},computed:{intermediateResults:function(){if(this.shuffle){var t=Array.from(this.results);return Object(l["a"])(t),t}return this.results},truncatedResults:function(){var t=this;return this.intermediateResults.filter((function(e,n){return n<t.resultsShown}))}},methods:{computeFilterLabel:function(t){return t.visibleCount===t.totalCount?t.label+" ("+t.visibleCount+")":t.label+" ("+t.visibleCount+"/"+t.totalCount+")"},computeListedItems:function(t){var e=this;return t.values.filter((function(t){return t.visibleCount>0||t.selected})).sort((function(t,e){return(e.selected?1e6:0)+e.visibleCount-(t.selected?1e6:0)-t.visibleCount})).map((function(t){return{text:e.computeFilterLabel(t),value:t.label,disabled:!t.enabled}}))},loadFilters:function(){var t=this,e=this.$route.query||{};function n(t){return Array.isArray(t)&&t||[t]}var r=Object.keys(e).flatMap((function(t){return n(e[t]).map((function(e){return t+"="+e}))})).join("&");this.axiosHelper("loading filters",(function(){return o.a.get(t.$apiUrl+"/diary/gagmine/filters?"+r)}),this.setFilterData)},loadFiltersFromExistingQuery:function(){var t=this;this.axiosHelper("loading filters",(function(){return o.a.get(t.$apiUrl+"/diary/gagmine/filters?"+t.query())}),(function(e){t.setFilterData(e),t.updateUrlFromSelections()}))},setFilterData:function(t){var e={};this.filters.forEach((function(t){return e[t.name]=t.values.filter((function(t){return t.selected})).map((function(t){return t.label}))})),t.forEach((function(t){t.listed=e[t.name]||[],t.values.forEach((function(e){return e.selected=t.listed.indexOf(e.label)>=0}))})),this.filters=t,this.filtersFirstLoaded&&(this.filtersFirstLoaded=!1,this.updateSelectionsFromUrl(),this.loadData())},query:function(){return this.filters.flatMap((function(t){return t.values.filter((function(t){return t.selected})).map((function(e){return t.name+"="+e.label}))})).join("&")},updateSelectionsFromUrl:function(){var t=this.$route.query||{};function e(t,e){return Array.isArray(t)&&t.indexOf(e)>=0||t===e}var n=this.filters;Object.keys(t).forEach((function(r){return n.filter((function(t){return t.name===r})).forEach((function(n){n.values.forEach((function(n){return n.selected=e(t[r],n.label)})),n.listed=n.values.filter((function(t){return t.enabled&&t.selected})).map((function(t){return t.label}))}))})),this.filters=n},loadData:function(){var t=this;this.resultsShown=30,this.axiosHelper("loading data",(function(){return o.a.get(t.$apiUrl+"/diary/gagmine/query?"+t.query())}),(function(e){return t.results=e}))},onListedFilterChange:function(t){t.values.forEach((function(e){return e.selected=t.listed.indexOf(e.label)>=0})),this.onFilterChange()},onFilterChange:function(){this.loadData(),this.loadFiltersFromExistingQuery()},updateUrlFromSelections:function(){var t={};this.filters.forEach((function(e){return t[e.name]=e.values.filter((function(t){return t.selected})).map((function(t){return t.label}))})),s["a"].replace({query:t}),this.updateLoginRdrHrefFromUrl()},updateLoginRdrHrefFromUrl:function(){this.loginRdrHref="/login-rdr?target="+encodeURIComponent(location.href)},showMore:function(){this.resultsShown+=50}},mounted:function(){this.loadFilters(),this.updateLoginRdrHrefFromUrl()}},h=d,p=(n("deff"),n("2877")),v=Object(p["a"])(h,r,i,!1,null,null,null);e["default"]=v.exports},"1caf":function(t,e,n){},"343b":function(t,e,n){"use strict";var r,i,a={name:"AxiosHelper",data:function(){return{alerts:[],restCallsGoing:0}},methods:{usefulErrorDetail:function(t){var e=t.response&&t.response.data||t;return"string"===typeof e?e:JSON.stringify(e)},axiosHelper:function(t,e,n){var r=this;return n?(this.restCallsGoing++,e().then((function(t){return n(t.data)})).catch((function(e){var n="Error "+t;console.log(n,e);var i=e.response&&e.response.status&&" ("+e.response.status+")"||"",a=r.usefulErrorDetail(e);r.alerts.push({type:"warning",text:n+i+": "+a})})).then((function(){return r.restCallsGoing--}))):this.axiosHelper(t,e,(function(){}))}}},o=a,s=n("2877"),l=Object(s["a"])(o,r,i,!1,null,null,null);e["a"]=l.exports},"4de4":function(t,e,n){"use strict";var r=n("23e7"),i=n("b727").filter,a=n("1dde"),o=a("filter");r({target:"Array",proto:!0,forced:!o},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(t,e,n){"use strict";var r=n("da84"),i=n("0366"),a=n("c65b"),o=n("7b0b"),s=n("9bdd"),l=n("e95a"),u=n("68ee"),c=n("07fa"),f=n("8418"),d=n("9a1f"),h=n("35a1"),p=r.Array;t.exports=function(t){var e=o(t),n=u(this),r=arguments.length,v=r>1?arguments[1]:void 0,b=void 0!==v;b&&(v=i(v,r>2?arguments[2]:void 0));var m,g,y,x,F,_,w=h(e),C=0;if(!w||this==p&&l(w))for(m=c(e),g=n?new this(m):p(m);m>C;C++)_=b?v(e[C],C):e[C],f(g,C,_);else for(x=d(e,w),F=x.next,g=n?new this:[];!(y=a(F,x)).done;C++)_=b?s(x,v,[y.value,C],!0):y.value,f(g,C,_);return g.length=C,g}},"53c4":function(t,e,n){},"5db7":function(t,e,n){"use strict";var r=n("23e7"),i=n("a2bf"),a=n("59ed"),o=n("7b0b"),s=n("07fa"),l=n("65f0");r({target:"Array",proto:!0},{flatMap:function(t){var e,n=o(this),r=s(n);return a(t),e=l(n,0),e.length=i(e,n,n,r,0,1,t,arguments.length>1?arguments[1]:void 0),e}})},"73d9":function(t,e,n){var r=n("44d2");r("flatMap")},"9bdd":function(t,e,n){var r=n("825a"),i=n("2a62");t.exports=function(t,e,n,a){try{return a?e(r(n)[0],n[1]):e(n)}catch(o){i(t,"throw",o)}}},a15b:function(t,e,n){"use strict";var r=n("23e7"),i=n("e330"),a=n("44ad"),o=n("fc6a"),s=n("a640"),l=i([].join),u=a!=Object,c=s("join",",");r({target:"Array",proto:!0,forced:u||!c},{join:function(t){return l(o(this),void 0===t?",":t)}})},a2bf:function(t,e,n){"use strict";var r=n("da84"),i=n("e8b5"),a=n("07fa"),o=n("0366"),s=r.TypeError,l=function(t,e,n,r,u,c,f,d){var h,p,v=u,b=0,m=!!f&&o(f,d);while(b<r){if(b in n){if(h=m?m(n[b],b,e):n[b],c>0&&i(h))p=a(h),v=l(t,e,h,p,v,c-1)-1;else{if(v>=9007199254740991)throw s("Exceed the acceptable array length");t[v]=h}v++}b++}return v};t.exports=l},a630:function(t,e,n){var r=n("23e7"),i=n("4df4"),a=n("1c7e"),o=!a((function(t){Array.from(t)}));r({target:"Array",stat:!0,forced:o},{from:i})},c4f7:function(t,e,n){"use strict";function r(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function i(t,e,n){"undefined"===typeof e&&(e=0),"undefined"===typeof n&&(n=t.length);for(var i=n-e,a=e;a<n;a++)r(t,e+Math.floor(Math.random()*i),e+Math.floor(Math.random()*i))}n.d(e,"a",(function(){return i}))},c975:function(t,e,n){"use strict";var r=n("23e7"),i=n("e330"),a=n("4d64").indexOf,o=n("a640"),s=i([].indexOf),l=!!s&&1/s([1],1,-0)<0,u=o("indexOf");r({target:"Array",proto:!0,forced:l||!u},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return l?s(this,t,e)||0:a(this,t,e)}})},cf45:function(t,e,n){"use strict";var r=n("53c4"),i=n.n(r);i.a},deff:function(t,e,n){"use strict";var r=n("1caf"),i=n.n(r);i.a},e985:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:{"alerts-outer-floating":t.floating}},t._l(t.alerts,(function(e,r){return n("v-alert",{key:e.text,attrs:{dismissible:"",elevation:"7",type:e.type},on:{input:function(e){return t.$delete(t.alerts,r)}}},[t._v(" "+t._s(e.text)+" ")])})),1)},i=[],a={name:"Notifications",props:["alerts","floating"]},o=a,s=(n("cf45"),n("2877")),l=Object(s["a"])(o,r,i,!1,null,null,null);e["a"]=l.exports}}]);
//# sourceMappingURL=chunk-40b4b478.0fde9e3a.js.map